import os
import shutil
import pickle
import numpy as np



# 1.load dataset to get pro & lig
fixed_path = r'E:\0430\code_DTA_0430\step1\output\func1_5_dataset_withoutNanCharge.pickle'
dataset_numpy = pickle.load(open(fixed_path, "rb"))
pdb_lig_array = dataset_numpy[:, 0:2]
pdb_lig_dict= {}
for i in pdb_lig_array:
    pdb_lig_dict[i[0]] = i[1]

# 2.  set outpath and inpath
out_pdb_path = "F:/LLL-doc/new_data_0501/pdbs_Bio_firstMODEL_firstLigand_nodisorder/"
out_3_pdb_path = out_pdb_path + "3_delALtLoc_delNoHetatm_addTER/"

in_pdb_path = out_pdb_path + "2_noDisorder/"


# 3.
def del_altLoc(curline):
    location = curline[16]
    if location != ' ':
        newline = curline[:16] + ' ' + curline[17:]
        return newline
    else:
        return curline


# 4.  main
count = 0
done_count = 0
miss_pdb = []
once_Het_Then_atom_pdbs = []
miss_hetatm = []
new_dataset = []

for idx in range(dataset_numpy.shape[0]):
    count += 1
    pdb = dataset_numpy[idx,0]
    print(count, pdb)
    lig = pdb_lig_dict[pdb]
    in_file = in_pdb_path + pdb + "_noDisorder.pdb"

    if os.path.exists(in_file):
        text = open(in_file).readlines()
        # write file
        out_Protein_file = out_3_pdb_path + pdb + "_delAltLocDelNoHetatmAddTER.pdb"

        chain_flag = -1
        first_chain = 0
        once_Het_Then_All_Het = "null"
        atom_line_list =[]
        hetatm_line_list = []

        for l_num in range(len(text)):
            line = text[l_num]
            if line.startswith("TER") or line.startswith("END"):
                atom_line_list.append(line)

            # 处理原子
            if line.startswith("ATOM"):
                if once_Het_Then_All_Het == "HETATM":
                    once_Het_Then_atom_pdbs.append(pdb)
                # pass
                once_Het_Then_All_Het = "ATOM"
                if line[21:22] != chain_flag:
                    if chain_flag != -1:
                        assert atom_line_list[-1].startswith("TER")
                    else:
                        first_chain = line[21:22]
                    chain_flag = line[21:22]

                new_line = del_altLoc(line)
                atom_line_list.append(new_line)


            # 处理小分子
            elif line.startswith("HETATM") and line[17:20] == lig:
                if once_Het_Then_All_Het == "ATOM":
                    if not atom_line_list[-1].startswith("TER"):  # add "TER" bewteen ATOM and HETATM
                        atom_line_list.append("TER" + "\n")

                new_line = del_altLoc(line)
                hetatm_line_list.append(new_line)  # for del empty HETATM
                atom_line_list.append(new_line)
                once_Het_Then_All_Het = "HETATM"

        if len(hetatm_line_list) == 0:
            miss_hetatm.append([pdb,lig])
            continue

        with open(out_Protein_file, 'w') as f:
            for i in atom_line_list:
                f.write(i)
            f.close()

        if True:
            done_count += 1
            new_dataset.append(dataset_numpy[idx,:])
    else:
        miss_pdb.append(pdb,lig)
    #break


print("miss_pdb", len(miss_pdb), miss_pdb)
print("once_Het_Then_atom_pdbs",len(once_Het_Then_atom_pdbs),once_Het_Then_atom_pdbs)
print("miss_hetatm",len(miss_hetatm),miss_hetatm)
print(count,done_count)

new_dataset = np.array(new_dataset)
pickle.dump(new_dataset, open("./output/func2_2_dataset_noEmptyHetatm.pickle", "wb"))
print("done")

"""
miss_pdb 0 []
once_Het_Then_atom_pdbs 2734 ['3zzf', '1wkm', '3k41', '2w97', '4lh2', '1qpb', '2hdq', '3e81', '5eb3', '4lh3', '3mwe', '3rup', '5ofv', '2it4', '1a7t', '1rdj', '2sfp', '2hdr', '3ern', '5ggj', '5ggl', '1y1m', '4ahv', '1mwt', '4x8s', '3i3d', '2hds', '3g2y', '3pce', '5nzq', '4x8t', '1rdi', '3ao4', '1njj', '4cs9', '3gv9', '4b0j', '2ay9', '5fe6', '3gqz', '6g47', '4ahr', '4ahs', '4amx', '5nzp', '1x8d', '2aac', '4aci', '4ury', '4x11', '1ajp', '3ao5', '3i3b', '1rdl', '2ay8', '5nzo', '1ew8', '3ao1', '4ahu', '4ddk', '2hdu', '3dyo', '3pcg', '5mz8', '5aol', '1z6d', '4iie', '3gtc', '3g2z', '5fsc', '3t0d', '4aj2', '1f73', '3dxg', '3pcb', '3mjl', '4ah9', '4ddm', '4x8u', '5aqh', '6fhq', '1gyx', '4efk', '4kz7', '3ad7', '3bf1', '3gr2', '3mfv', '3vdb', '4urz', '3ovn', '5n53', '3gvb', '4o3a', '4wef', '5g46', '5foo', '4i8x', '1o8b', '4b3d', '5aqj', '5aqp', '3elc', '2fzc', '2uyn', '3gsg', '4wks', '5fsx', '2vyt', '4m6u', '4ndu', '2bet', '4g5y', '4kz3', '4ykk', '5aqn', '3zt4', '4kz8', '5ofw', '3djx', '4oyt', '4rrg', '3ppr', '4k7i', '3moh', '3zt2', '4cgj', '5aqo', '3zt3', '1ugp', '2wpb', '2wtx', '3g31', '4kzb', '4llx', '6b7b', '6f6s', '6mvu', '3c2u', '5aom', '1ms0', '1h2k', '3k8c', '4ai5', '4ef6', '4lm3', '4u4s', '5ct2', '6fv4', '1ykp', '3g34', '3imc', '3img', '4owm', '3djq', '4ibc', '5aba', '5aqu', '1ecq', '1hqg', '1ws4', '2rka', '3grj', '3ime', '4l51', '4llk', '4r3w', '4u0w', '5aqr', '6f6n', '1ogd', '2ha3', '3adv', '4lm2', '4qp2', '3t08', '4i7k', '4lm4', '1f74', '4g5f', '4guj', '5abe', '3mof', '1ugw', '1ec9', '1pu7', '1pu8', '3f78', '4cjr', '1uod', '3c2r', '4aj1', '4ajk', '4d52', '4cgi', '5ey4', '5c5t', '2ya7', '1noi', '4de5', '4fzj', '5e5g', '2ymd', '3ad8', '3kpu', '3lk0', '5n1x', '4hnc', '1lbk', '1o6i', '3dxh', '3g1v', '6f6i', '5cs6', '5ijr', '1s5z', '1ew9', '1tog', '4n5d', '5y79', '1px4', '3zsy', '4lm1', '5qay', '5o0a', '6g9b', '3ta1', '4lm0', '4zij', '1l5s', '4wkt', '3ioe', '1bcu', '2xgs', '3tfu', '3zsx', '5moe', '5yf1', '1d7j', '1tpw', '3hcm', '4ddh', '4mrw', '4msa', '5g45', '1i2s', '5fe7', '2wk6', '4cjp', '4i7j', '2pnc', '4b0b', '4b5t', '4b5w', '3ry8', '4cp5', '3pwk', '3zxe', '4lkq', '4u7o', '4wet', '2vc7', '4cj4', '4wyp', '3d8z', '2fzg', '3a73', '3tay', '5l8o', '2j9h', '4ms0', '3d8y', '5qaw', '5qaz', '2w08', '3iob', '3kqp', '4c71', '4llj', '4n8q', '5aqv', '4umc', '4c6z', '3muz', '5qal', '3nyd', '4k7n', '5qaj', '1c5o', '4avs', '4b5s', '4i7p', '5aqt', '5dtt', '5h1u', '5m4q', '5mby', '5qaf', '1jys', '2j27', '3mfw', '4c70', '4mrz', '5qa5', '5vfn', '5ggk', '5qaq', '6f5u', '2ay3', '2cle', '2clf', '2clm', '3qvu', '4aji', '4mjr', '4n98', '5btx', '5dts', '5dva', '1np0', '4ck3', '4ibb', '5a7b', '5csh', '1gww', '2gsu', '4cjq', '1d1p', '1d7i', '1qw7', '2fzk', '2qpu', '3b3x', '3g0i', '4c1y', '5lvr', '5qac', '3sk2', '3pcc', '3st6', '4bkt', '4rrf', '5qae', '5qao', '5dqe', '1gyy', '2rk8', '4gui', '4iuo', '5qa9', '4agl', '4y4v', '5aqk', '5qab', '3pcn', '3t2q', '4aia', '5ggn', '5nzn', '5qak', '4cig', '4ibd', '4n99', '5fog', '1c3x', '3ioc', '3isj', '4aje', '4io7', '4isu', '3clp', '3d7b', '4ovg', '5os7', '6gg4', '1bcj', '1wht', '2bjm', '2bvr', '3l59', '3n7a', '4b2d', '4kza', '5qag', '3fj7', '3g32', '4mjq', '5qas', '3fjg', '6g46', '3kpv', '5khj', '3d6p', '2x09', '3d6q', '4c6x', '5qa6', '2v2h', '3ao2', '3kqm', '4q46', '5qa4', '5qa8', '5qad', '5qar', '5aqf', '2clk', '3t09', '4ajl', '5ech', '5eci', '5h1t', '5qax', '5qb0', '2o9a', '3ai8', '5wbf', '1hn4', '4bks', '4mmm', '5qai', '6f5w', '3lzz', '4kv9', '5acw', '5qah', '1sre', '2wzs', '2yb0', '3kqo', '3mv0', '3wq5', '4kiu', '5dhp', '5qat', '6czd', '3lbz', '4i9u', '5g4m', '5ldm', '5oh9', '1v16', '4nbk', '5oh3', '3si4', '5eqe', '4aj4', '4nl1', '2vhj', '3zvw', '4n9c', '3l5b', '5qaa', '1ahx', '1pr5', '3fgc', '3twp', '2a5b', '1v1m', '2v3d', '4rgd', '5o1g', '5o1c', '6cbg', '2fpz', '2vi5', '3c39', '4zmf', '5qa7', '5qan', '1l5q', '2flh', '4agn', '1v11', '2g8r', '4i7l', '1kqb', '1nu3', '2ot1', '2rin', '2whp', '3ijh', '3vd9', '4p6c', '4umb', '5fpp', '5g4n', '5h1v', '5qam', '5qap', '5wcm', '3kqw', '2wvz', '3po1', '5vsj', '2q8m', '3bxh', '4msn', '5e2l', '5nzf', '6fns', '1l7x', '1r4w', '1tuf', '2rk7', '2w66', '3n8k', '2clh', '2clo', '1gj4', '1hyo', '2v2v', '4xmr', '5ot9', '1y2g', '2d06', '1o0n', '4fxp', '4qkd', '1odj', '3iod', '1d6s', '1p19', '3d6o', '3ncr', '4ih5', '5kam', '3a1d', '3ivc', '3mkn', '4de2', '4whq', '4whr', '4whs', '3qto', '4ovf', '4i7m', '5dq8', '5lvq', '1m2x', '2v2q', '3c8e', '3q8h', '5qau', '5qav', '5qb2', '3si3', '5ito', '5bw4', '3q2j', '5o0b', '3cft', '3sv2', '4n9a', '1ghw', '3djp', '3qx5', '5ot8', '1odi', '1qk4', '4bqs', '5jcb', '5wbo', '1gx0', '1kv5', '1t5f', '3f80', '4own', '2jke', '2jkp', '5umw', '2bes', '3h78', '5cu2', '5f8y', '5oh2', '5u0w', '5km9', '5om9', '3qwc', '6gnm', '1m5w', '1gx4', '2vzr', '3i4a', '3jrs', '4wcf', '5l4j', '6b7d', '1e2l', '3zyh', '4i3z', '2cli', '2cll', '3t0b', '4eoh', '4k7o', '4o61', '4wyz', '4zme', '5dtk', '5zku', '5zla', '6fug', '6fuj', '5qb3', '6f20', '2ha6', '4u43', '4ucc', '1olx', '4zcs', '6czb', '1e3v', '1z6s', '2ha5', '1ghv', '1yfz', '4owv', '5mf6', '2jdy', '2zif', '4gu9', '5oh7', '3b24', '3guz', '3u9q', '2hjb', '3djo', '5orh', '2pwd', '4omk', '4pp0', '6cha', '1olu', '2ypp', '3uxd', '4exs', '4usi', '5km2', '1tjp', '3qvv', '2a3c', '2ha0', '2pu2', '3kqr', '4dsy', '4kcx', '4qf9', '4ykj', '5f2p', '5g4o', '5kad', '3pd3', '4rrr', '2wbg', '3atp', '4g2r', '3bmn', '3jq8', '3jqa', '3jqf', '4gki', '5c3p', '5dpx', '5jox', '3skk', '4owo', '5el2', '6f05', '2ogy', '3p17', '3pd4', '4dhl', '4oks', '5a7y', '5o1e', '5yto', '6c5f', '6hoy', '1o7o', '3kmy', '6b7a', '2eg8', '3n7h', '5yl2', '2yog', '3uug', '4g90', '4jxv', '5aqg', '5l8n', '1gu1', '1z4n', '1z4o', '2ra6', '4trc', '5o1f', '6ami', '3h30', '2zz1', '2zz2', '3iub', '4b76', '4x3t', '5gmm', '3aqa', '3djv', '3p8p', '3ppq', '4myd', '5c2o', '5oh4', '6gnp', '1w2g', '2uzj', '3n8n', '4fp1', '4or4', '4yrd', '5j7q', '1fj4', '1l2s', '2jiw', '3f3t', '4g8y', '6fnq', '1upf', '2pyy', '2v54', '2vb8', '2vba', '2x0y', '2yof', '4bc5', '4dfb', '4dfu', '4jal', '5km3', '5n1p', '2bo4', '3lgs', '4io4', '5ulp', '13gs', '1f4f', '1joc', '1ofz', '2a5c', '2xm2', '3umq', '6f1j', '4hzm', '2z3h', '5etl', '5jhk', '6fcl', '2w87', '3qtv', '4w9c', '6b98', '1m1b', '2ha2', '3egk', '3mss', '4hso', '5ndb', '5o1d', '2h23', '3vw1', '4gkh', '5jsq', '1wn6', '1xge', '2ypo', '3g35', '3rv6', '4ymg', '5aoj', '5fe9', '6fnt', '2rio', '4mgd', '4tpw', '1c5n', '2cex', '2dw7', '2fu8', '2j9n', '2qfo', '3k5i', '3lm1', '5o1b', '5qb1', '5vfj', '5wbm', '6fba', '3fnm', '4cu1', '4yb5', '5kma', '5otc', '2o1c', '3b9g', '3f6g', '3r6c', '4jxw', '4ayu', '4e5j', '1w4p', '2e2p', '2uxu', '3f3u', '3g3d', '3jqg', '3qs8', '4ih6', '5ov8', '3vw2', '1q8t', '3o5n', '4au7', '4wop', '1l5r', '2afw', '3rm9', '4uoh', '5iyy', '5orj', '4ad6', '6czc', '3dnd', '4aq6', '4llp', '1v1j', '1xff', '2gl0', '2jal', '2pwg', '2ypi', '3kmx', '3kqy', '3vd4', '4ih3', '4io6', '4kwf', '4rlu', '5ewa', '3a1s', '5vjp', '1nhw', '4kif', '4uof', '5d1r', '1vkj', '2j4k', '2r9x', '2ww2', '3cj2', '3f70', '3kpw', '3ohi', '3qnd', '3rv7', '3zyf', '4iic', '4ovh', '5abf', '5o1h', '5yfs', '4rlw', '6apu', '3exh', '3lp4', '5nwe', '6clv', '1p1q', '2j77', '2vo5', '3njq', '4l9i', '4pnu', '5ii2', '5j7w', '5oha', '5z7b', '6am8', '3cf8', '5l8a', '1h1p', '1jqy', '2haw', '3i6c', '3rv8', '3rv9', '4c73', '5ytu', '2y7k', '3uxk', '4ido', '1e2k', '2vo4', '4ts1', '4bup', '4cft', '5yz2', '1cea', '1gj5', '1o5g', '2vjx', '2w67', '2yoh', '3bxg', '3n87', '3veh', '4rlt', '2wd7', '3lle', '3qbc', '6f4x', '4mqp', '4w9d', '5gj9', '5v8p', '6gnw', '1hlk', '1kr3', '1nc3', '1sbr', '1w2h', '2oiq', '2oym', '3cfn', '3d1g', '3ufa', '4xoe', '5itp', '5o3r', '5yft', '2glp', '3ads', '4dds', '4u4x', '2d0k', '3usx', '4io5', '6emu', '4jym', '5f25', '4oct', '4pnw', '4yzu', '5acx', '5i3a', '6d50', '6exi', '2v77', '3f68', '5c1w', '5vjn', '2xm1', '2yfa', '3axm', '3juo', '4knz', '5hwv', '5u12', '6dik', '2qtg', '3m94', '3tb6', '4oiv', '5j32', '1m48', '4c72', '5fhm', '1m6p', '1o0o', '2r9w', '3bxs', '3ujb', '6ap8', '3k4d', '3ozj', '5kej', '1qaw', '1uv6', '4f1l', '4m5n', '5f74', '5vsb', '1gcz', '3s9e', '2hqu', '2xi7', '2yaz', '3bls', '3kr2', '3tao', '4ejl', '5kva', '6b7c', '6gw1', '1jcx', '1jvu', '1o0m', '1qk3', '1thz', '2afx', '3e6k', '3p8e', '1jqd', '6mjf', '2zfp', '3b7j', '4gkm', '5ahw', '5fdz', '6cbf', '4duh', '4iif', '6ar9', '3kqs', '3uu1', '4a6s', '5f91', '3b2t', '4few', '4m0r', '5wag', '1bq4', '1ucn', '1w4o', '2gz2', '2zxd', '3dne', '3lq2', '3lq4', '3ms9', '3n1c', '3ppp', '3qxt', '5dkr', '5ev8', '3lc3', '5tzo', '1q8w', '1s89', '2jfz', '4ih7', '4non', '4y59', '3r24', '5b5f', '5b5g', '5twj', '1w4q', '3n9s', '4omj', '5gs9', '3bmo', '4jfs', '4r6w', '5ltn', '3bbf', '4e70', '5faq', '2wc4', '2xzw', '3pcu', '5hrx', '1a69', '1o0f', '1pr1', '1srg', '1vyq', '2o1v', '2oyk', '2q7q', '3pgl', '3ri1', '4ob0', '5n16', '4or6', '5km0', '1lvu', '1oim', '4yb6', '5g1z', '5n17', '6g0z', '2c80', '3rzi', '4giu', '1hee', '1zgi', '3kqt', '3nee', '3nrz', '4mg5', '5l4m', '5u14', '5wp5', '6ap7', '2fxv', '3e9b', '3r8i', '5u11', '3ldq', '3mf5', '2hj4', '3qt6', '4dpy', '4du8', '5cdh', '6ap6', '6cb5', '1ke0', '2h2j', '2qhd', '3tif', '1qbv', '2h6b', '4cl6', '4ej8', '2c1p', '2f35', '2i80', '2jdm', '3b4p', '3pch', '4ij1', '4m3p', '4pin', '5eqp', '5l9o', '5lsg', '5mqe', '5o1i', '4tun', '4uma', '5cbs', '5u13', '1p28', '2vpo', '4fev', '4nxv', '4pox', '1syi', '3lp7', '4dju', '4mgb', '6gnr', '2iko', '3mi3', '1lv8', '2y4k', '4jft', '4mvn', '5owa', '6ekq', '2xde', '3pd2', '4n7m', '4rrq', '1g85', '2cbv', '2zkj', '3bxe', '3d2r', '4kp8', '4pf5', '4uc5', '4ycu', '5hrw', '5ii1', '6grp', '3bmq', '3ga5', '4lv3', '4tq3', '4w9f', '5avf', '3tza', '6gr7', '3da9', '3kgt', '4zgk', '5cks', '5lpk', '6gfz', '1oe7', '1oe8', '1ydr', '3hqr', '4de3', '4en4', '5j1x', '5wqj', '6f4w', '1kdw', '2y7i', '3bxf', '4nxu', '2iuz', '3uzj', '4p5e', '5gja', '2jdn', '5lpm', '2nmx', '3bex', '3coz', '3uxl', '3jup', '1mfi', '3sha', '4kxm', '5afv', '5n9r', '6fnr', '3qce', '3qcf', '5osk', '2bmk', '3e3c', '3ldp', '3lpl', '3nes', '4ddy', '4iid', '4mg6', '6c99', '3rf5', '2reg', '3n86', '4deu', '1hq5', '1n5r', '1nhu', '2erz', '2op9', '3iuc', '3td4', '4gs9', '4jls', '5c28', '5ouh', '6f28', '6gon', '6goo', '1ow4', '2an5', '2c92', '2cbu', '2q8z', '2vr4', '4det', '4l4z', '4mg9', '5n18', '5o3q', '1a99', '1egh', '1g98', '1n1m', '2f2h', '2h3e', '2i4p', '2i4z', '2o3z', '2ya6', '3bar', '3dkj', '4bs0', '4hnn', '4j28', '4pio', '4qxq', '6f9g', '6hd6', '2qg0', '2v25', '3shc', '4br3', '4dkp', '5du8', '6eyt', '3m3z', '2b1v', '2flb', '2pgz', '3ivx', '3jyj', '3kr1', '4lps', '4o2a', '4o2b', '5mwh', '5ota', '5u4b', '6gu6', '2ya8', '2qta', '4a95', '4muv', '1kds', '2boj', '3k8d', '3rm4', '4fxq', '4q9o', '5za2', '6eij', '4l4v', '2y5h', '5mo8', '1kpm', '4g8v', '4rhx', '4ysl', '6gu2', '1h8s', '1ols', '2nn1', '3iue', '3qqs', '4dld', '4p5d', '4z84', '5il1', '4do5', '4km2', '1q54', '1u1w', '2vmf', '3e5u', '4b6r', '4des', '4qdk', '5egu', '5mme', '5ndf', '4azc', '4mga', '5cyi', '1y8o', '1ydk', '2eg7', '2qm7', '4arb', '4de0', '4hva', '4q3q', '5l4f', '5t8p', '4kne', '4csd', '5ets', '6bt6', '1kyv', '1o0h', '1yds', '1yms', '2ans', '2xn3', '3jq7', '3kgu', '3neo', '4kyh', '4rdn', '4y5d', '5fh6', '5owl', '1fv0', '3lmk', '5a6k', '1q8u', '2j79', '3rw9', '4de1', '4msc', '4w9i', '5hv0', '5n21', '5vcw', '1uwt', '4nkt', '5vse', '1uwu', '3e12', '5n55', '1ado', '1ceb', '1d2e', '1gt1', '1hn2', '1ssq', '1xgj', '2izl', '2vqt', '3nex', '3ucj', '4kwg', '4p3h', '4qxr', '4rao', '5f1r', '5olk', '5u4c', '6f90', '2vl4', '4b6s', '5egs', '2xwe', '3coy', '3jqb', '1n8v', '4f9u', '4f9v', '2w2i', '4km0', '5ll5', '6g3v', '2q11', '3d04', '3gus', '3pcf', '4ara', '4eoi', '4eol', '4eon', '4eop', '5g2g', '5n0f', '5ur9', '6apt', '3sfg', '3sjt', '4io3', '4l50', '5c29', '1mmp', '3fvl', '3le8', '1sri', '2wc3', '4kp5', '5ll9', '5u0y', '1ogx', '1dzk', '1gt5', '2cvd', '2e7f', '2flr', '3cke', '3v2n', '4glw', '4kxn', '4kzq', '4l19', '5efh', '5knx', '5n58', '5u4g', '1g32', '2qx0', '4kao', '5kax', '1nc1', '1o2g', '2wvt', '4irx', '4k4j', '6fmj', '4q18', '2c97', '1u0g', '3bh3', '3v4x', '4f6u', '2i4j', '3lpg', '5f2k', '2kce', '4b9k', '4fht', '3amb', '5km1', '1tpz', '2bt9', '4r8y', '4wrb', '5aiv', '5u0z', '6fu4', '2aj8', '3p9t', '4k6i', '1aht', '2zm3', '4mul', '4ymb', '4z6h', '5en3', '5ttf', '2o7e', '3e9i', '3lpp', '3o0g', '3p2e', '3pb3', '4kxl', '4m0e', '3wzq', '4u0x', '5ett', '5hu0', '5wa8', '1hnn', '1ym1', '2fai', '5ais', '6eir', '1zky', '3rf4', '4bcp', '6czi', '1wcq', '1pbq', '2j94', '3bfu', '4q3r', '2gfd', '4djw', '5ix0', '5nz4', '1yyr', '3v2q', '4d8z', '4r06', '5t2t', '5vsc', '2jg8', '2oyl', '2vrj', '3ebl', '3k5v', '3t70', '4eor', '4oag', '4ob1', '4ob2', '4pow', '5brn', '5wqk', '2op3', '3u93', '4cpy', '4d1j', '4der', '4z6i', '5gmh', '1w3j', '2wnc', '4mgc', '6upj', '2y1w', '4nbl', '5ab9', '5nu5', '5u48', '5u4d', '5u4f', '1i00', '3cj5', '4hev', '4muf', '4z0k', '5kbe', '6d5j', '2j7f', '3ed0', '5u4e', '6cvf', '3v2p', '4mg7', '5ant', '5d3x', '5u4a', '5ucj', '5xo7', '2qpq', '3o88', '4r91', '5klz', '2q2c', '2wcg', '2ybu', '5v7a', '1lol', '5nze', '6csq', '10gs', '1i7z', '1usk', '3jq9', '3k1j', '3pn3', '3tf6', '3zll', '4je7', '4mss', '4zxy', '5uk8', '5ura', '6f92', '1i80', '2xxw', '2xxx', '5ihh', '5v79', '1w0y', '2j78', '5x62', '6eiq', '4ge1', '5w8j', '1jqe', '2jh5', '2y59', '3s9y', '4da5', '4q3u', '6hqy', '1gt3', '1ro6', '2xd9', '4n07', '4ymh', '5dbm', '5fl0', '5iwg', '5uc4', '3cm2', '4jzb', '4mq6', '4zji', '5he5', '6b4l', '1f4g', '2wnj', '4mg8', '4q0a', '4q3t', '5etq', '5may', '6fe0', '1dl7', '1fsw', '3bft', '4gv8', '4hw3', '5oq7', '5tuo', '2g72', '4kzu', '4mme', '5kew', '5tt8', '2xjj', '3cj4', '4e3o', '4nka', '4zbi', '5t8o', '6faf', '1alw', '1gt4', '1k9s', '2ima', '2nn7', '2oxy', '2pfy', '2v3e', '4dko', '4dkr', '4uj1', '5etr', '3ama', '3wtj', '2h21', '3fuz', '3hii', '4a4v', '4aqh', '4ht2', '4pv5', '5n69', '1dhj', '1n4h', '2bok', '2i3v', '2xxr', '5sym', '6bu3', '4db7', '5h5o', '5yyb', '6f3b', '1wva', '2hzl', '4fs4', '5evz', '1c2t', '1c3e', '2e91', '4q3s', '4xas', '5ew0', '5l4i', '5vja', '2j4g', '2jdp', '3lxe', '3v3q', '5k48', '5l7e', '5mb1', '5z7j', '6d5g', '6eis', '2j7b', '2jgs', '3aav', '5syn', '5w10', '2yfe', '4k77', '6b97', '1lcp', '2b1g', '2d3z', '2za0', '3b26', '2j75', '4yha', '2xj7', '2yz3', '3zj6', '5wyx', '6aps', '3ew2', '5fho', '6b1k', '3ie3', '3lpf', '3o75', '3zhx', '5o4f', '6ayi', '2xn5', '5a6x', '5yhe', '1a50', '1dfo', '1hp0', '1ke3', '1koj', '1nki', '1nms', '1rdt', '3eko', '3pck', '3t60', '3t64', '4io2', '4mue', '4o2p', '5g5v', '5nvv', '5tt3', '6ee2', '2jdu', '2vpn', '2zz6', '3aqt', '4djv', '4flp', '4i73', '4w9h', '5am6', '5gvm', '1usi', '2zc9', '2zgx', '4hwr', '4lxz', '5uzk', '5xsu', '5yu9', '3ikd', '5wa9', '1bkj', '3fas', '3fvn', '4j8t', '4x48', '5ayt', '5fh8', '5nvw', '5ugh', '5mte', '2rcb', '4wkv', '1fl3', '1nq7', '3fx6', '3s2v', '3t03', '4u0s', '5elv', '5wae', '6cve', '2uwp', '1fsy', '1lrh', '1nnu', '1tr7', '2b1i', '2c94', '2d41', '3wzp', '4gkc', '3e6v', '4bcq', '1bhx', '2y5g', '6csr', '1xk9', '1xt8', '4k3h', '5f1v', '6d5e', '3pyy', '5fh7', '5nih', '6gl9', '4bco', '4n4s', '5tci', '1uz1', '2e92', '2f34', '3fvg', '3qip', '3r4n', '6glb', '3cow', '3gbb', '4zzx', '4bcm', '1m9n', '1pkx', '1swr', '2d3u', '3r1v', '3u6w', '3wto', '4k10', '6d5h', '2z7h', '6b1c', '1c5c', '1d3v', '1x8j', '2e93', '3exe', '4dai', '4i54', '4rpn', '5fat', '6apv', '5umy', '1my4', '4av0', '6eif', '4bcs', '4fai', '4fbe', '1fki', '2j7g', '3dux', '3g15', '3kdm', '3m2u', '3wtm', '3wzn', '3zyu', '4dew', '5boj', '5fl4', '5g22', '5l8c', '5l9i', '5mwy', '1ypj', '3pbb', '4ajo', '5hz9', '5vsf', '6b2c', '2aov', '3wtl', '3wtn', '4p6x', '2bq7', '2wer', '4h3j', '4zsh', '5gvn', '1bwn', '2zsc', '4zzz', '4wmy', '5hva', '1ga9', '3rlp', '4yw6', '2bz6', '4ghi', '5gsa', '6hrq', '1lhg', '2f7i', '2v57', '2wjg', '3udd', '3zdg', '4azg', '4bbh', '4bny', '4rad', '4tyo', '4uj2', '4ymx', '5l9l', '3u15', '5ula', '2x2r', '3d2t', '3hww', '3kej', '4caf', '4daf', '4e0x', '2j7d', '4arw', '4zbf', '5lom', '2vot', '4wov', '4xaq', '5ehr', '3n9r', '3o86', '4eej', '4pct', '4xt2', '5hvs', '4ajn', '2doo', '2i6b', '4nks', '5bv3', '6htg', '4q9m', '1hsl', '1los', '2j7h', '3gdt', '3ips', '5am7', '2g8n', '2xii', '3c79', '2yek', '3v7t', '4av5', '4b73', '5kly', '2epn', '3cyz', '3k99', '3pcj', '3uz5', '4zy2', '4avh', '4djx', '5e2m', '5if6', '1oyt', '2psv', '3ikg', '3n3g', '3o84', '3p3t', '4ha5', '5dh4', '5vsd', '5xmx', '2ces', '2ole', '3p3r', '4xx3', '1dhi', '2f8i', '2xib', '3cz1', '4efg', '4ly1', '5hvt', '1fdq', '2ceq', '4alx', '5j7p', '5w12', '4do4', '6fa4', '1nhg', '1sw1', '2i3i', '2uxi', '2vvn', '3c52', '3t0w', '4dpu', '5l7h', '6ckr', '3qt7', '4nyf', '5tbm', '6ex1', '1ydt', '2j7e', '3ipu', '3kv2', '5hdx', '2j2u', '2r2m', '3dhk', '5ek9', '6hlz', '6hm2', '1uw6', '2ydw', '5ttg', '5w14', '3rtf', '3zdh', '5hdz', '1swg', '4gu6', '4xx4', '5fl6', '6d55', '5ufp', '6b1j', '6b1w', '4ede', '5igm', '5tcj', '2hzy', '4na9', '1b55', '1oar', '3re4', '3rlq', '3zi0', '4len', '4lv1', '4qjo', '4x0u', '4z83', '5tuz', '6b1x', '6b1y', '1ik4', '2q2a', '3s5y', '4r92', '4wn5', '6fyz', '1q5k', '2xys', '3zm9', '5wac', '1pi4', '2isv', '2isw', '1vzq', '4avj', '4x21', '1n0s', '4azi', '1my8', '1yei', '1yej', '2g71', '2p53', '3kyg', '5msb', '5fas', '3qxm', '3u92', '2xdm', '2ynd', '3m6r', '5doh', '5nud', '6b16', '5mwp', '2vwo', '5myg', '5usy', '6fhk', '1bm7', '2mas', '3ekr', '3rlr', '4ijq', '4rac', '4ty6', '2f1g', '4exz', '4hu1', '4ruu', '5hes', '6cwf', '6cwh', '6cwi', '6eee', '3e9h', '4asj', '6hsh', '1c3b', '1d09', '1q95', '3fkv', '3ocp', '4fnn', '6gla', '3bm6', '3p3s', '4zy5', '3kr4', '3liw', '3o87', '4m8h', '4uyf', '4uyg', '6css', '6guc', '1ftm', '1no9', '4dbm', '4uin', '4avi', '5v13', '1c1v', '1e5a', '3d78', '3fat', '3k5k', '3l0v', '4r73', '4rpo', '5eie', '1f0r', '2cn0', '2yme', '3k83', '4b74', '4e5w', '4oeu', '5tcy', '5w13', '1j07', '1t4v', '2p1c', '3miy', '4cpz', '4d7b', '4ygf', '5un9', '5wyz', '6hke', '1iem', '2agv', '2d1o', '2hmv', '2psj', '2ves', '3k7f', '3th9', '4acc', '4fsl', '4q0l', '5he4', '5l9g', '6cn5', '6gbx', '1oif', '4a4w', '5lla', '2aou', '1f0s', '1j36', '1nfu', '1rd4', '2v59', '4auy', '4cae', '4j22', '4pp5', '5od5', '4x50', '5fwr', '4hwp', '1my2', '1pi5', '2g70', '2jh6', '2qm9', '3mi2', '4gzt', '5cbm', '5g1n', '5neb', '4knn', '4q1d', '5ueu', '2zwz', '2i19', '3czv', '4c1m', '4qjw', '4r93', '5l7g', '5eu1', '1nvs', '1yly', '2cf9', '2j34', '3vx3', '4pp3', '4qpd', '5hdv', '3ttn', '6b96', '3c84', '4pcs', '4r76', '4r95', '4x5r', '5f1h', '5uc1', '5wuk', '3ccw', '4ele', '2ajl', '3c56', '3hig', '4b5d', '4g8m', '4m8e', '5csd', '5fb7', '5m56', '2e9v', '4bcn', '4hbm', '4hge', '4j5p', '5aix', '6en5', '6en6', '4bxk', '2qe4', '3a5y', '3g5d', '3uuo', '4k3n', '4y79', '4yt6', '6chn', '3ldw', '4z07', '1a4k', '1b57', '1dqn', '1tkb', '1ypg', '2e94', '2vnt', '2vwn', '2z8e', '3t0x', '4a6l', '4ehz', '4knm', '4lv2', '4o9v', '4poh', '4ujb', '4zjj', '5eqy', '5o22', '6eq8', '2cet', '4uye', '4yes', '4zy0', '5t3n', '2b9a', '2jkh', '2xcg', '2xxt', '2y80', '3u8l', '4q19', '4wmc', '4y8d', '5abg', '5ld8', '5upe', '6chl', '6d56', '6evr', '1jtq', '2q70', '1lhf', '3tu7', '4elh', '4his', '5n6s', '5two', '1ghy', '1l6m', '1stc', '1ype', '2cf8', '2vvu', '3kr8', '4poj', '4r74', '5a6b', '5m7u', '1nvr', '3fv2', '4ge4', '5wad', '2yk1', '4pop', '3ljz', '3odu', '4buq', '4isi', '4zy1', '2d1n', '3i4b', '3nxq', '4eo8', '4ge7', '4loo', '4lop', '4loq', '5u4x', '2g63', '4q1e', '3hpt', '5acy', '5fl5', '6ayq', '2jds', '2jdv', '5zo8', '2ff1', '2ff2', '4hiq', '1h1s', '2cji', '2vvv', '3le9', '4h3g', '4hym', '4lko', '5k8s', '5w8v', '3e5a', '4kfq', '1jd0', '1c1u', '1nvq', '2pbw', '3cen', '6gzm', '2cbj', '3hek', '4djy', '4pov', '1a28', '4bj8', '6ayo', '1qbq', '1tom', '2aeb', '2pll', '2v7a', '3bjm', '4afg', '4cpa', '4zy6', '5he7', '5khm', '5oah', '6das', '4pee', '5c2a', '5eef', '5fky', '1bzy', '5ime', '3m6p', '3kek', '3oj8', '4e6q', '3t1a', '4bao', '4v24', '1k21', '1mu6', '4g3e', '5d21', '6ayr', '1k22', '2al5', '2uwl', '2y82', '2zda', '3d0e', '3qxv', '3sww', '4bck', '4cnh', '4nh7', '5fa7', '5hd0', '5ll4', '5org', '6gue', '1e4h', '2g5p', '4wa9', '5vl2', '2za5', '5dey', '6h7n', '2oag', '3b28', '6fe1', '2g5u', '5fl1', '5ufs', '7upj', '3u8j', '1rp7', '1ta2', '2bxt', '2wn9', '3k84', '3tct', '3ttm', '4e3l', '4h1e', '4h3i', '4xoc', '5mpk', '6csp', '3kjd', '4hwo', '6e2o', '1q1g', '2yne', '2wky', '5nbw', '4qjp', '5upf', '4ban', '4hf4', '5htz', '1mue', '2qry', '4qd6', '4ydn', '6std', '2oax', '3nox', '3u8k', '5hu1', '5cj6', '1jgl', '2jh0', '2pcp', '2uwo', '2wyg', '2y7z', '2y81', '3brn', '4bah', '4eo6', '4hy1', '4q1c', '4rwj', '4uj9', '5hcv', '5ufr', '2wj1', '4bkj', '4ivb', '4q1b', '6b1f', '6b1h', '1mjj', '2wtv', '4ei4', '1qft', '4e4l', '4frs', '5abh', '5y80', '1ryf', '5vm0', '1yz3', '2p93', '3fvk', '4i5c', '5kby', '2obf', '5mlj', '1n3i', '1nfy', '2y7x', '4e3i', '4pxm', '3egt', '4bak', '3k37', '4e3j', '4e6d', '5kbf', '4bam', '1j37', '1nfw', '4und', '4xo8', '5een', '1ag9', '1ba8', '1mu8', '1mxo', '1y0l', '2i03', '2wyj', '3ui7', '4h3f', '4s2i', '5ef7', '5hdu', '4baq', '4jh0', '1ezq', '4e4n', '4i72', '4uja', '5m7s', '1nw4', '3gba', '4jnj', '3x00', '6ckw', '2g5t', '2v58', '2w8y', '2z92', '3lea', '4e3k', '4hws', '5nwz', '1d9i', '5vad', '1ta6', '2wb5', '4mf1', '2p94', '1z71', '3ozg', '1mh5', '4s1g', '5eei', '5llp', '6g3o', '2xab', '3nzk', '1xow', '2ao6', '3vhd', '830c', '3fv1', '4q1a', '4qge', '3wha', '5waf', '2r6w', '2z4b', '1flm', '2p95', '1ksn', '1sqn', '2izx', '2o4r', '2w26', '3fw4', '4erf', '4qac', '5llo', '2aa6', '2phb', '2r6y', '2p4s', '2bys', '2gvj', '3g5k', '4dve', '4ewh', '4ivd', '1lhe', '2pog', '3ppm', '3pr0', '4afh', '5e2n', '2jj3', '4wkp', '4lsj', '1lhd', '2zx8', '4b7r', '5dh5', '3dp9', '1df8', '4e3m', '4fk6', '4m1j', '4crl', '2i0g', '3e8r', '4yhm', '456c', '5lxb', '4x24', '1h1b', '1pvn', '4ear', '4eb8', '4wup', '5ywx', '2drc', '3erd', '2vnp', '3rlb', '1flr', '1rjk', '2zo3', '4ivc', '4lhv', '4twp', '2o4j', '2p16', '1y6r', '6chp', '4f3k', '3u8n', '4ww8', '4ggz', '5etj', '5dyo', '2p15', '4e3n', '4std', '1lhc', '2zx7', '5std', '1n46', '4yo8', '1g2o', '5dro', '2zx6', '2wva', '7std', '4yho', '1ebg', '6h5x', '1dqx', '1eix', '1x1z', '3k8o', '3std', '5h8e', '2xpk', '4f2w', '4gbd', '2j62', '4wkb', '4jn2', '1y6q', '4wr7', '1duv', '4f3c', '1rbo', '2f01', '2gh7', '2uyw']
miss_hetatm 57 [['2b1r', 'CBI'], ['2d2v', 'MAL'], ['1a0t', 'SUC'], ['2b1q', 'TRE'], ['2o9r', 'TCB'], ['2zgm', 'LAT'], ['1ga8', 'DEL'], ['1rdn', 'MAG'], ['1wdq', 'MAL'], ['1icj', 'PGO'], ['1qi0', 'CBI'], ['4jck', '1LL'], ['1wdr', 'MAL'], ['1gwv', 'LAT'], ['4ouj', 'LBT'], ['3alt', 'MLB'], ['1ws5', 'MAM'], ['3i8t', 'LBT'], ['5duw', '5GO'], ['4ipn', '1FT'], ['1gzc', 'LAT'], ['2nn8', 'LAT'], ['3uwl', 'FOZ'], ['3f5l', 'LB2'], ['2y9g', 'LAT'], ['3ap4', 'LBT'], ['1z3t', 'CBI'], ['1x9d', 'SMD'], ['5t7s', 'LBT'], ['1z3v', 'LAT'], ['3oyw', 'TDG'], ['5uff', '8B7'], ['4xtp', 'TNR'], ['4jc1', 'TDG'], ['1oko', 'GLB'], ['5a3h', 'FFC'], ['4xxh', 'T6P'], ['2f5t', 'MAL'], ['2rfy', 'CBI'], ['2cht', 'BAR'], ['3zi8', 'FU4'], ['6cjv', 'G2Y'], ['1n7m', 'NMP'], ['1urg', 'MAL'], ['4ayp', 'SMD'], ['4pfu', 'MAB'], ['6eiz', 'FOH'], ['3nw3', 'MU2'], ['1tyr', 'REA'], ['6epz', 'MLB'], ['4o0r', 'X4Z'], ['2qwe', 'GNA'], ['2x4z', 'X4Z'], ['4pft', 'MAB'], ['5n9n', '8QK'], ['4wko', 'HCE'], ['5c1m', '4VO']]
5693 5636
done
"""

